SELECT DISTINCT 
CL.SRC_SYS ,
CL.LOB ,
CL.MEMBER_ID,
CL.SUBSCRIBER_ID ,
CONCAT(M.FIRST_NAME,',' ,M.LAST_NAME) AS Client_NAME  ,
M.DOB AS Date_of_Birth,M.DOD AS Date_of_Death,
M.HICN AS Medicare_Number ,
M.MEDICAID_NUMBER ,
C.PATIENT_ACCT_NO ,
C.CLAIM_ADJUSTED_FROM ,
C.CLAIM_ADJUSTED_TO ,
CL.CLAIM_ID ,
CL.CLAIM_LINE_SEQ_NUM ,
CL.SERVICE_FROM_DT ,
CL.SERVICE_TO_DT ,
CL.STMT_FROM_DT ,
CL.STMT_TO_DT ,
CL.CLAIM_STATUS_DESC ,
CL.CLAIM_STATUS ,
CL.CHARGE_AMT ,
CL.ALLOWED_AMT ,
CL.PAID_AMT ,
CL.PAID_DT ,
CL.UNITS ,
CL.UNITS_ALLOW ,
C.BILL_CLASS ,
CL.BILLTYPE ,
C.BILL_FREQUENCY ,
CL.PROC_CD ,
CL.PROC_CD_DESC ,
CL.CPT ,
CL.HCPCS_CD_MOD1 ,
CL.HCPCS_CD_MOD2,
CL.HCPCS_CD_MOD3 ,
CL.HCPCS_CD_MOD4 , 
C.SERVICE_PROVIDER_ID ,
C.SERVICE_PROVIDER_NAME ,
C.SERVICE_PROVIDER_NPI ,
C.SERVICE_PROVIDER_TAX_ID ,
C.PAYEE_IND ,
C.PAYEE_PROVIDER_ID ,
C.PAYEE_PROVIDER_NAME ,
C.PAYEE_PROVIDER_NPI ,
C.PAYEE_PROVIDER_TAX_ID ,
C.CHECK_NO 
FROM DLAKE.CHOICE.FCT_CLAIM_UNIVERSE_CURR AS C
INNER JOIN DLAKE.CHOICE.FCT_CLAIM_LINE_UNIVERSE_CURR AS CL ON CL.CLAIM_ID =C.CLAIM_ID AND CL.MEMBER_ID =C.MEMBER_ID AND C.SERVICE_FROM_DT =CL.SERVICE_FROM_DT 
INNER JOIN DLAKE.CHOICE.DIM_MEMBER AS M ON M.MEMBER_ID AND C.MEMBER_ID AND M.MEMBER_ID =CL.MEMBER_ID 
WHERE 
C.SRC_SYS ='TMG'
AND CL.SRC_SYS ='TMG'
AND C.SERVICE_FROM_DT >='2023-01-01'
AND CL.SERVICE_FROM_DT >='2023-01-01'
AND C.SERVICE_FROM_DT >M.DOD  
AND CL.SERVICE_FROM_DT >M.DOD 
AND C.CLAIM_STATUS_DESC ='PAID'
AND CL.CLAIM_STATUS_DESC ='PAID'
AND C.CLAIM_ADJUSTED_TO  IS NULL
AND M.DL_ACTIVE_REC_IND ='Y'
AND M.DOD IS NOT NULL
ORDER BY CL.CLAIM_ID ,CL.CLAIM_LINE_SEQ_NUM 
